const configuration = require('../config.json')
const _ = require('lodash');

function findValue(arr,value) {
  return _.filter(arr, function (object) {
    return object['name'].toLowerCase().indexOf(value.toLowerCase()) >= 0;
  });
}

function checkKey(key) {
	if(configuration.token_keys.includes(key))
		return true
	return false
}
function getPayload(_params) {
	let methodPayload = findValue(configuration.methods, _params.method)
	methodPayload = methodPayload[0]
	if(methodPayload) {
		methodPayload.command = methodPayload.command.replace('%1target1%', _params.target)
		methodPayload.command = methodPayload.command.replace('%1port1%', _params.port)
		methodPayload.command = methodPayload.command.replace('%1duration1%', _params.duration)
		return methodPayload.command
	}
	return false
}
function checkIsIPV4(target) {
  var blocks = target.split(".");
  if(blocks.length === 4) {
    return blocks.every(function(block) {
      return parseInt(block,10) >=0 && parseInt(block,10) <= 255;
    });
  }
  return false;
}
module.exports = {
	checkKey,
	getPayload,
	checkIsIPV4
}